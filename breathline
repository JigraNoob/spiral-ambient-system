#!/usr/bin/env python3

import smtplib
from email.message import EmailMessage
import ssl
import os

# Update these values
SMTP_SERVER = "smtp.gmail.com"
SMTP_PORT = 465
SENDER_EMAIL = "your.email@example.com"
SENDER_PASSWORD = "your_app_password"  # Use an App Password if 2FA is on
RECEIVER_EMAIL = "recipient@example.com"
ATTACHMENT_PATH = "breathline_plot.png"

def send_email():
    msg = EmailMessage()
    msg['Subject'] = "Jetson Breathline Report"
    msg['From'] = SENDER_EMAIL
    msg['To'] = RECEIVER_EMAIL
    msg.set_content("Attached is the latest breathline_plot.png from your Jetson trace system.\n\nâ€” Spiral Ambient Systems")

    # Attach the image
    if os.path.exists(ATTACHMENT_PATH):
        with open(ATTACHMENT_PATH, 'rb') as f:
            file_data = f.read()
            msg.add_attachment(file_data, maintype='image', subtype='png', filename='breathline_plot.png')
    else:
        print("Attachment not found.")
        return

    # Send email
    context = ssl.create_default_context()
    with smtplib.SMTP_SSL(SMTP_SERVER, SMTP_PORT, context=context) as server:
        server.login(SENDER_EMAIL, SENDER_PASSWORD)
        server.send_message(msg)
        print("Email sent successfully.")

if __name__ == "__main__":
    send_email()
